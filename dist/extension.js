(()=>{"use strict";var e={53:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.PythonHandler=void 0;const o=s(n(398)),c=s(n(928)),l=n(958),u=n(491),d=n(688),h=n(898),m=n(949);class f extends l.BaseLanguageHandler{constructor(){super("python",[".py",".pyw"],75,!1)}canHandle(e){if("python"===e.languageId)return!0;const t=e.fileName.toLowerCase();return t.endsWith(".py")||t.endsWith(".pyw")}async extractReference(e,t){return(0,m.measureAsync)("PythonHandler.extractReference",async()=>{try{let n=this.getCachedSymbols(e);n||(n=await h.SymbolResolver.getDocumentSymbols(e)||null,n&&this.setCachedSymbols(e,n));const r=this.getPythonModulePath(e);if(!n||0===n.length)return new u.ReferenceFormat(r,"standard",void 0,".",t.line+1,t.character+1,r);const{symbol:a,parents:i}=h.SymbolResolver.findSymbolAtPosition(n,t);if(!a&&0===i.length)return new u.ReferenceFormat(r,"standard",void 0,".",t.line+1,t.character+1,r);const s=this.buildPythonSymbolPath(i,a);return new u.ReferenceFormat(r,"standard",s,".",void 0,void 0,r)}catch(n){return null}},{languageId:e.languageId})}async resolveSymbol(e,t){return(0,m.measureAsync)("PythonHandler.resolveSymbol",async()=>{try{const n=await h.SymbolResolver.getDocumentSymbols(e);if(!n)return null;const{symbol:r,parents:a}=h.SymbolResolver.findSymbolAtPosition(n,t);return new u.SymbolContext(e,t,e.languageId,r,a,void 0)}catch(n){return null}},{languageId:e.languageId})}formatReference(e){const t=this.getPythonModulePath(e.document),n=e.getFullSymbolPath();return new u.ReferenceFormat(t,"standard",n,".",void 0,void 0,t)}getPythonModulePath(e){const t=d.ReferenceFormatter.getRelativePath(e.uri);if("__init__.py"===c.basename(t))return c.dirname(t).replace(/\//g,".").replace(/\\/g,".");let n=t.replace(/\.(py|pyw)$/i,"");n=n.replace(/\//g,".").replace(/\\/g,".");const r=["src","lib","app"];for(const a of r)if(n.startsWith(`${a}.`)){n=n.substring(a.length+1);break}return n}buildPythonSymbolPath(e,t){const n=[];for(const r of e)r.kind===o.SymbolKind.Class?n.push(r.name):r.kind!==o.SymbolKind.Module&&r.kind!==o.SymbolKind.Namespace||n.push(r.name);if(t){const e=t.name;t.kind===o.SymbolKind.Property||e.startsWith("__")&&e.endsWith("__"),n.push(e)}return n}}t.PythonHandler=f},144:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.handlerRegistry=void 0,t.activate=function(e){const t=u.CacheManager.getInstance(),n=d.TelemetryReporter.getInstance();n.initialize(e),n.trackEvent(d.TelemetryEvents.FEATURE_USAGE,{feature:"extension_activated"}),k.clear(),k.register(new S.JavaHandler),k.register(new g.JavaScriptHandler),k.register(new p.PythonHandler),k.register(new y.MarkdownHandler),k.register(new b.HtmlHandler),k.register(new v.YamlHandler),k.register(new w.FlutterHandler),k.setFallback(new f.UniversalHandler);const r=o.commands.registerCommand("extension.copyReference",async()=>{await async function(){const e=d.TelemetryReporter.getInstance(),t=Date.now(),n=o.window.activeTextEditor;if(!n)return o.window.showInformationMessage(l.LocalizationManager.getMessage("extension.copyReference.noEditor")),void e.trackEvent(d.TelemetryEvents.COPY_REFERENCE,{result:"no_editor"});const r=n.document,a=n.selection.active,i=k.getHandler(r);if(!i)return o.window.showErrorMessage(l.LocalizationManager.getMessage("extension.copyReference.noHandler")),void e.trackEvent(d.TelemetryEvents.COPY_REFERENCE,{result:"no_handler",languageId:r.languageId});try{const n=await i.extractReference(r,a);if(!n)return o.window.showInformationMessage(l.LocalizationManager.getMessage("extension.copyReference.failed")),void e.trackLanguageUsage(r.languageId,i.languageId,!1);const s=n.toString();if(await c.ClipboardManager.writeText(s)){const a=l.LocalizationManager.getMessage("extension.copyReference.copied");o.window.showInformationMessage(`${a}: ${s}`);const c=Date.now()-t;e.trackLanguageUsage(r.languageId,i.languageId,!0),e.trackPerformance("copyReference",c),n.frameworkType&&e.trackEvent(d.TelemetryEvents.FRAMEWORK_DETECTED,{framework:n.frameworkType,languageId:r.languageId})}}catch(s){o.window.showErrorMessage(l.LocalizationManager.getMessage("extension.copyReference.failed")),e.trackError(s,"copyReference")}}()}),a=o.commands.registerCommand("extension.copyReferenceWithFormat",async()=>{await async function(){const e=d.TelemetryReporter.getInstance(),t=Date.now(),n=o.window.activeTextEditor;if(!n)return o.window.showInformationMessage(l.LocalizationManager.getMessage("extension.copyReference.noEditor")),void e.trackEvent(d.TelemetryEvents.COPY_REFERENCE,{result:"no_editor"});const r=n.document,a=n.selection.active,i=k.getHandler(r);if(!i)return o.window.showErrorMessage(l.LocalizationManager.getMessage("extension.copyReference.noHandler")),void e.trackEvent(d.TelemetryEvents.COPY_REFERENCE,{result:"no_handler",languageId:r.languageId});try{const n=await i.extractReference(r,a);if(!n)return o.window.showInformationMessage(l.LocalizationManager.getMessage("extension.copyReference.failed")),void e.trackLanguageUsage(r.languageId,i.languageId,!1);const s=P.FormatManager.getInstance(),u=await s.showFormatPicker(r.languageId);if(!u)return;const h={package:n.modulePath,class:n.symbolPath?.[n.symbolPath.length-2],method:n.symbolPath?.[n.symbolPath.length-1],file:n.filePath,fileName:n.filePath.split("/").pop(),line:n.lineNumber,column:n.columnNumber,fullReference:n.toString(),symbolPath:n.symbolPath,separator:n.separator,languageId:r.languageId,workspace:o.workspace.name},m=s.format(h,u.format);if(await c.ClipboardManager.writeText(m)){u.remember&&s.setLastUsedFormat(u.format);const n=l.LocalizationManager.getMessage("extension.copyReference.copied");o.window.showInformationMessage(`${n}: ${m}`);const a=Date.now()-t;e.trackLanguageUsage(r.languageId,i.languageId,!0),e.trackPerformance("copyReferenceWithFormat",a),e.trackEvent(d.TelemetryEvents.FEATURE_USAGE,{feature:"multi_format",format:u.format})}}catch(s){o.window.showErrorMessage(l.LocalizationManager.getMessage("extension.copyReference.failed")),e.trackError(s,"copyReferenceWithFormat")}}()}),i=o.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("copyReference")&&t.clearAll()}),s=o.workspace.onDidChangeTextDocument(e=>{t.clear(e.document.uri)}),_=o.workspace.onDidCloseTextDocument(e=>{t.clear(e.uri)});e.extensionMode===o.ExtensionMode.Development&&(0,h.registerBenchmarkCommand)(e),(0,m.registerFeedbackCommand)(e),e.subscriptions.push(r,a,i,s,_)},t.deactivate=function(){u.CacheManager.getInstance().clearAll(),k.clear()};const o=s(n(398)),c=n(645),l=n(678),u=n(265),d=n(880),h=n(479),m=n(760),f=n(886),g=n(368),p=n(53),y=n(326),b=n(870),v=n(528),w=n(325),S=n(171),P=n(618),k=new class{constructor(){this.handlers=new Map,this.fallbackHandler=null}register(e){this.handlers.set(e.languageId,e),e.fileExtensions.forEach(t=>{const n=`ext:${t}`,r=this.handlers.get(n);(!r||e.priority>r.priority)&&this.handlers.set(n,e)})}setFallback(e){this.fallbackHandler=e}getHandler(e){let t=this.handlers.get(e.languageId);if(t&&t.canHandle(e))return t;const n=e.fileName.split(".").pop();if(n&&(t=this.handlers.get(`ext:${n}`),t&&t.canHandle(e)))return t;const r=Array.from(this.handlers.values()).filter((e,t,n)=>n.indexOf(e)===t).sort((e,t)=>t.priority-e.priority);for(const a of r)if(a.canHandle(e))return a;return this.fallbackHandler}getAllHandlers(){const e=new Set(this.handlers.values());return Array.from(e)}isLanguageSupported(e){return this.handlers.has(e)||null!==this.fallbackHandler}clear(){this.handlers.clear(),this.fallbackHandler=null}};t.handlerRegistry=k},171:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.JavaHandler=void 0;const o=s(n(398)),c=n(958),l=n(491),u=n(898),d=n(949);class h extends c.BaseLanguageHandler{constructor(){super("java",[".java",".kt",".kts"],80,!1)}canHandle(e){if("java"===e.languageId||"kotlin"===e.languageId)return!0;const t=e.fileName.toLowerCase();return t.endsWith(".java")||t.endsWith(".kt")||t.endsWith(".kts")}async extractReference(e,t){return(0,d.measureAsync)("JavaHandler.extractReference",async()=>{try{let n=this.getCachedSymbols(e);n||(n=await u.SymbolResolver.getDocumentSymbols(e)||null,n&&this.setCachedSymbols(e,n));const r=await this.getPackageName(e);if(!r)return null;if(!n||0===n.length)return new l.ReferenceFormat(r,"standard",void 0,".",t.line+1,t.character+1,r);const{symbol:a,parents:i}=u.SymbolResolver.findSymbolAtPosition(n,t),s=this.findClassSymbol(i,a);if(!s)return new l.ReferenceFormat(r,"standard",void 0,".",t.line+1,t.character+1,r);const c=this.buildJavaSymbolPath(r,s,a,i),d=a&&a!==s&&(a.kind===o.SymbolKind.Method||a.kind===o.SymbolKind.Constructor||a.kind===o.SymbolKind.Function);return new l.ReferenceFormat(r,"standard",c,d?"#":".",void 0,void 0,r)}catch(n){return null}},{languageId:e.languageId})}async resolveSymbol(e,t){return(0,d.measureAsync)("JavaHandler.resolveSymbol",async()=>{try{const n=await u.SymbolResolver.getDocumentSymbols(e);if(!n)return null;const{symbol:r,parents:a}=u.SymbolResolver.findSymbolAtPosition(n,t);return new l.SymbolContext(e,t,e.languageId,r,a,void 0)}catch(n){return null}},{languageId:e.languageId})}formatReference(e){const t=this.getPackageNameSync(e.document);if(!t)return null;const n=this.findClassSymbol(e.parentSymbols,e.symbol),r=this.buildJavaSymbolPath(t,n,e.symbol,e.parentSymbols),a=e.symbol&&e.symbol!==n&&(e.symbol.kind===o.SymbolKind.Method||e.symbol.kind===o.SymbolKind.Constructor||e.symbol.kind===o.SymbolKind.Function);return new l.ReferenceFormat(t,"standard",r,a?"#":".",void 0,void 0,t)}async getPackageName(e){try{const t=e.getText().split("\n");for(const e of t){const t=e.match(/package\s+([\w.]+)/);if(t)return t[1].trim()}}catch(t){}return null}getPackageNameSync(e){try{const t=e.getText().split("\n");for(const e of t){const t=e.match(/package\s+([\w.]+)/);if(t)return t[1].trim()}}catch(t){}return null}findClassSymbol(e,t){if(t&&this.isClassLike(t))return t;for(let n=e.length-1;n>=0;n--)if(this.isClassLike(e[n]))return e[n]}isClassLike(e){return e.kind===o.SymbolKind.Class||e.kind===o.SymbolKind.Interface||e.kind===o.SymbolKind.Enum||e.kind===o.SymbolKind.Struct}buildJavaSymbolPath(e,t,n,r){const a=[];if(a.push(...e.split(".")),!t)return a;const i=r.indexOf(t),s=[];if(s.push(t),i>=0&&n&&n!==t)for(let o=i+1;o<r.length;o++)this.isClassLike(r[o])&&s.push(r[o]);for(const o of s)a.push(o.name);return n&&n!==t&&!this.isClassLike(n)&&(n.kind!==o.SymbolKind.Method&&n.kind!==o.SymbolKind.Constructor&&n.kind!==o.SymbolKind.Function||a.push(n.name)),a}}t.JavaHandler=h},265:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.CacheManager=t.EvictionStrategy=void 0;const o=s(n(398)),c=n(491),l=n(880);var u;!function(e){e.LRU="lru",e.LFU="lfu",e.FIFO="fifo",e.ADAPTIVE="adaptive"}(u||(t.EvictionStrategy=u={}));class d extends c.CacheEntry{constructor(e,t,n){super(e,t,n),this.lastAccessTime=new Date,this.createdTime=new Date,this.sizeInBytes=this.estimateSize(n),this.priority=1}touch(){super.touch(),this.lastAccessTime=new Date}calculatePriority(){const e=Date.now()-this.createdTime.getTime(),t=Date.now()-this.lastAccessTime.getTime(),n=this.accessCount,r=1/(1+t/1e3),a=1/(1+e/1e3);return this.priority=.5*n+.3*r+.2*a,this.priority}estimateSize(e){return 100*e.length}}class h{constructor(){this.cache=new Map,this.maxCacheSize=50,this.maxMemorySize=10485760,this.currentMemoryUsage=0,this.cacheTimeout=3e5,this.evictionStrategy=u.ADAPTIVE,this.loadConfiguration(),this.statistics={hits:0,misses:0,evictions:0,currentSize:0,maxSize:this.maxCacheSize,averageAge:0,hitRate:0},this.telemetry=l.TelemetryReporter.getInstance(),this.startCleanupInterval(),o.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("copyReference.cache")&&(this.loadConfiguration(),this.restartCleanupInterval())})}loadConfiguration(){const e=o.workspace.getConfiguration("copyReference.cache");this.maxCacheSize=e.get("maxSize",50),this.maxMemorySize=1024*e.get("maxMemoryMB",10)*1024,this.cacheTimeout=e.get("ttl",3e5),this.evictionStrategy=e.get("evictionStrategy",u.ADAPTIVE)}startCleanupInterval(){this.cleanupInterval=setInterval(()=>{this.performMaintenance()},6e4)}restartCleanupInterval(){this.cleanupInterval&&clearInterval(this.cleanupInterval),this.startCleanupInterval()}static getInstance(){return h.instance||(h.instance=new h),h.instance}get(e){const t=e.uri.toString(),n=this.cache.get(t);return n&&n.isValid(e)?(n.touch(),this.statistics.hits++,this.telemetry.trackEvent(l.TelemetryEvents.CACHE_HIT,{languageId:e.languageId}),this.updateStatistics(),n.symbols):(this.statistics.misses++,this.telemetry.trackEvent(l.TelemetryEvents.CACHE_MISS,{languageId:e.languageId}),this.updateStatistics(),null)}set(e,t){const n=e.uri.toString(),r=new d(n,e.version,t);this.shouldEvict(r)&&this.evictEntries(r.sizeInBytes);const a=this.cache.get(n);a&&(this.currentMemoryUsage-=a.sizeInBytes),this.cache.set(n,r),this.currentMemoryUsage+=r.sizeInBytes,this.statistics.currentSize=this.cache.size}shouldEvict(e){return this.cache.size>=this.maxCacheSize&&!this.cache.has(e.documentUri)||this.currentMemoryUsage+e.sizeInBytes>this.maxMemorySize}evictEntries(e){let t=0;const n=[];switch(this.evictionStrategy){case u.LRU:n.push(...this.selectLRUEntries(e));break;case u.LFU:n.push(...this.selectLFUEntries(e));break;case u.FIFO:n.push(...this.selectFIFOEntries(e));break;case u.ADAPTIVE:n.push(...this.selectAdaptiveEntries(e))}n.forEach(e=>{const n=this.cache.get(e);n&&(t+=n.sizeInBytes,this.currentMemoryUsage-=n.sizeInBytes,this.cache.delete(e),this.statistics.evictions++)}),this.telemetry.trackEvent("cache_eviction",{strategy:this.evictionStrategy,evictedCount:n.length,evictedBytes:t})}selectLRUEntries(e){const t=Array.from(this.cache.entries()).sort((e,t)=>e[1].lastAccessTime.getTime()-t[1].lastAccessTime.getTime());return this.selectEntriesToFreeSpace(t,e)}selectLFUEntries(e){const t=Array.from(this.cache.entries()).sort((e,t)=>e[1].accessCount-t[1].accessCount);return this.selectEntriesToFreeSpace(t,e)}selectFIFOEntries(e){const t=Array.from(this.cache.entries()).sort((e,t)=>e[1].createdTime.getTime()-t[1].createdTime.getTime());return this.selectEntriesToFreeSpace(t,e)}selectAdaptiveEntries(e){for(const n of this.cache.values())n.calculatePriority();const t=Array.from(this.cache.entries()).sort((e,t)=>e[1].priority-t[1].priority);return this.selectEntriesToFreeSpace(t,e)}selectEntriesToFreeSpace(e,t){const n=[];let r=0;for(const[a,i]of e){if(r>=t&&n.length>0)break;n.push(a),r+=i.sizeInBytes}return n}performMaintenance(){this.cleanExpiredEntries(),this.updateStatistics(),this.statistics.currentSize>0&&this.telemetry.trackEvent("cache_statistics",{size:this.statistics.currentSize,hitRate:this.statistics.hitRate.toFixed(2),memoryUsageMB:(this.currentMemoryUsage/1024/1024).toFixed(2)})}cleanExpiredEntries(){const e=[];for(const[t,n]of this.cache.entries())n.getAge()>this.cacheTimeout&&(e.push(t),this.currentMemoryUsage-=n.sizeInBytes);e.forEach(e=>this.cache.delete(e)),this.statistics.currentSize=this.cache.size}updateStatistics(){const e=this.statistics.hits+this.statistics.misses;if(this.statistics.hitRate=e>0?this.statistics.hits/e:0,this.cache.size>0){const e=Array.from(this.cache.values()).reduce((e,t)=>e+t.getAge(),0);this.statistics.averageAge=e/this.cache.size}else this.statistics.averageAge=0}clear(e){const t=e.toString(),n=this.cache.get(t);n&&(this.currentMemoryUsage-=n.sizeInBytes,this.cache.delete(t),this.statistics.currentSize=this.cache.size)}clearAll(){this.cache.clear(),this.currentMemoryUsage=0,this.statistics={hits:0,misses:0,evictions:0,currentSize:0,maxSize:this.maxCacheSize,averageAge:0,hitRate:0}}getStats(){return this.updateStatistics(),{...this.statistics}}getDetailedInfo(){const e=Array.from(this.cache.entries()).map(([e,t])=>({uri:e,version:t.documentVersion,accessCount:t.accessCount,age:t.getAge(),size:t.sizeInBytes,priority:t.priority}));return{statistics:this.getStats(),memoryUsage:{current:this.currentMemoryUsage,max:this.maxMemorySize,percentage:this.currentMemoryUsage/this.maxMemorySize*100},entries:e}}dispose(){this.cleanupInterval&&clearInterval(this.cleanupInterval),this.clearAll()}}t.CacheManager=h},325:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterHandler=void 0;const o=s(n(398)),c=s(n(928)),l=s(n(896)),u=n(958),d=n(491);class h extends u.BaseLanguageHandler{constructor(){super("flutter",[".dart"],85,!0),this.packageNameCache=new Map}canHandle(e){return"dart"===e.languageId||super.canHandle(e)}formatReference(e){try{const t=this.getPackageInfoSync(e.document),n=this.getModulePath(e.document,t);return e.symbol?this.buildFlutterReference(e,n,t):new d.ReferenceFormat(n,"standard",void 0,"#",e.position.line+1,e.position.character+1,n)}catch(t){return null}}buildFlutterReference(e,t,n){const r=[],a=e.symbol,i=this.findWidgetClass(e),s=this.findStateClass(e);if(i)s?(r.push(i.name),a.kind===o.SymbolKind.Method&&"build"!==a.name?r.push(a.name):"build"===a.name&&r.push("build")):(r.push(i.name),a.name!==i.name&&r.push(a.name));else{const t=e.getFullSymbolPath();r.push(...t)}let c;if(n){const e=this.getRelativePathFromLib(t);c=`package:${n.name}/${e}`}else c=t;return r.length>0&&(c+="#"+r.join(".")),new d.ReferenceFormat(c,"standard",r.length>0?r:void 0,"#",e.position.line+1,e.position.character+1,n?`package:${n.name}/${this.getRelativePathFromLib(t)}`:t,i?"flutter":void 0)}findWidgetClass(e){const t=(e.parentSymbols||[]).find(e=>e.kind===o.SymbolKind.Class);if(t){if(t.name.startsWith("_")&&t.name.endsWith("State"))return{name:t.name.slice(1).replace(/State$/,""),kind:o.SymbolKind.Class,range:t.range,selectionRange:t.selectionRange,children:[],detail:"StatefulWidget"};const e=t.detail||"";if(e.includes("StatelessWidget")||e.includes("StatefulWidget"))return t}return null}findStateClass(e){return(e.parentSymbols||[]).find(e=>e.kind===o.SymbolKind.Class&&e.name.startsWith("_")&&e.name.endsWith("State"))||null}getPackageInfoSync(e){const t=o.workspace.getWorkspaceFolder(e.uri);if(!t)return null;const n=t.uri.fsPath;if(this.packageNameCache.has(n))return{name:this.packageNameCache.get(n),path:n};const r=c.join(n,"pubspec.yaml");try{if(l.existsSync(r)){const e=l.readFileSync(r,"utf8").match(/^name:\s*(.+)$/m);if(e){const t=e[1].trim();return this.packageNameCache.set(n,t),{name:t,path:n}}}}catch(a){}return null}getModulePath(e,t){const n=o.workspace.getWorkspaceFolder(e.uri);return n?c.relative(n.uri.fsPath,e.fileName).replace(/\\/g,"/"):c.basename(e.fileName)}getRelativePathFromLib(e){return e.startsWith("lib/")?e.substring(4):e}}t.FlutterHandler=h},326:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownHandler=void 0;const o=s(n(398)),c=n(958),l=n(491),u=n(688),d=n(898),h=n(949);class m extends c.BaseLanguageHandler{constructor(){super("markdown",[".md",".markdown",".mdown",".mkd"],60,!1)}canHandle(e){if("markdown"===e.languageId)return!0;const t=e.fileName.toLowerCase();return this.fileExtensions.some(e=>t.endsWith(e))}async extractReference(e,t){return(0,h.measureAsync)("MarkdownHandler.extractReference",async()=>{try{const n=u.ReferenceFormatter.getRelativePath(e.uri);let r=this.getCachedSymbols(e);if(r||(r=await d.SymbolResolver.getDocumentSymbols(e)||null,r&&this.setCachedSymbols(e,r)),!r||0===r.length)return new l.ReferenceFormat(n,"standard",void 0,"#",t.line+1,t.character+1,n);const a=this.findHeadingAtPosition(r,t);if(!a)return new l.ReferenceFormat(n,"standard",void 0,"#",t.line+1,t.character+1,n);const i=this.generateGitHubAnchor(a.name,r);return new l.ReferenceFormat(n,"standard",[i],"#",void 0,void 0,n)}catch(n){return null}},{languageId:e.languageId})}async resolveSymbol(e,t){return(0,h.measureAsync)("MarkdownHandler.resolveSymbol",async()=>{try{const n=await d.SymbolResolver.getDocumentSymbols(e);if(!n)return null;const r=this.findHeadingAtPosition(n,t);if(!r)return null;const a=this.findParentHeadings(n,r);return new l.SymbolContext(e,t,e.languageId,r,a,void 0)}catch(n){return null}},{languageId:e.languageId})}formatReference(e){const t=u.ReferenceFormatter.getRelativePath(e.document.uri);if(!e.symbol)return new l.ReferenceFormat(t,"standard",void 0,"#",e.position.line+1,e.position.character+1,t);const n=this.generateGitHubAnchor(e.symbol.name,[]);return new l.ReferenceFormat(t,"standard",[n],"#",void 0,void 0,t)}findHeadingAtPosition(e,t){let n=null,r=-1;const a=e=>{for(const i of e){if(this.isHeadingSymbol(i)){const e=i.range.start.line;e<=t.line&&e>r&&(n=i,r=e)}i.children&&i.children.length>0&&a(i.children)}};return a(e),n}isHeadingSymbol(e){return e.kind===o.SymbolKind.String||e.kind===o.SymbolKind.Constant||e.kind===o.SymbolKind.Module||e.kind===o.SymbolKind.Namespace}findParentHeadings(e,t){const n=[],r=(e,a)=>{for(const i of e){if(i===t)return n.push(...a),!0;if(i.children&&i.children.length>0){const e=[...a];if(this.isHeadingSymbol(i)&&e.push(i),r(i.children,e))return!0}}return!1};return r(e,[]),n}generateGitHubAnchor(e,t){let n=e.replace(/[\u{1F300}-\u{1F9FF}]|[\u{2600}-\u{26FF}]/gu,"").trim();if(n=n.toLowerCase(),n=n.replace(/[^\w\u4e00-\u9fa5]+/g,"-"),n=n.replace(/^-+|-+$/g,""),t.length>0){const r=new Map,a=e=>{for(const t of e){if(this.isHeadingSymbol(t)){const e=this.generateGitHubAnchor(t.name,[]),n=r.get(e)||0;r.set(e,n+1)}t.children&&a(t.children)}};if(a(t),(r.get(n)||0)>1){let r=0;const a=t=>{for(const i of t){if(this.isHeadingSymbol(i)&&this.generateGitHubAnchor(i.name,[])===n){if(i.name===e)return!0;r++}if(i.children&&a(i.children))return!0}return!1};a(t),r>0&&(n=`${n}-${r}`)}}return n}}t.MarkdownHandler=m},368:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.JavaScriptHandler=void 0;const o=s(n(398)),c=s(n(928)),l=n(958),u=n(491),d=n(688),h=n(898),m=n(949);class f extends l.BaseLanguageHandler{constructor(){super("javascript",[".js",".jsx",".ts",".tsx",".mjs",".cjs"],80,!0)}canHandle(e){return!!["javascript","javascriptreact","typescript","typescriptreact"].includes(e.languageId)||super.canHandle(e)}async extractReference(e,t){return(0,m.measureAsync)("JavaScriptHandler.extractReference",async()=>{try{let n=this.getCachedSymbols(e);n||(n=await h.SymbolResolver.getDocumentSymbols(e)||null,n&&this.setCachedSymbols(e,n));const r=this.getModulePath(e);if(!n||0===n.length)return new u.ReferenceFormat(r,"standard",void 0,"#",t.line+1,t.character+1,r);const{symbol:a,parents:i}=h.SymbolResolver.findSymbolAtPosition(n,t);if(!a&&0===i.length)return new u.ReferenceFormat(r,"standard",void 0,"#",t.line+1,t.character+1,r);const s=h.SymbolResolver.buildSymbolPath(i,a),o=this.detectReactFramework(e,a,i);return new u.ReferenceFormat(r,"standard",s,"#",void 0,void 0,r,o)}catch(n){return null}},{languageId:e.languageId})}async resolveSymbol(e,t){return(0,m.measureAsync)("JavaScriptHandler.resolveSymbol",async()=>{try{const n=await h.SymbolResolver.getDocumentSymbols(e);if(!n)return null;const{symbol:r,parents:a}=h.SymbolResolver.findSymbolAtPosition(n,t),i=this.detectReactFramework(e,r,a);return new u.SymbolContext(e,t,e.languageId,r,a,i)}catch(n){return null}},{languageId:e.languageId})}formatReference(e){const t=this.getModulePath(e.document),n=e.getFullSymbolPath();return new u.ReferenceFormat(t,"standard",n,"#",void 0,void 0,t)}getModulePath(e){let t=d.ReferenceFormatter.getRelativePath(e.uri).replace(/\.(js|jsx|ts|tsx|mjs|cjs)$/i,"");return"index"===c.basename(t)&&(t=c.dirname(t)),t.startsWith("src/")&&(t=t.substring(4)),t=t.replace(/\\/g,"/"),t}async detectFramework(e){const t=e.getText();return/import\s+.*\s+from\s+['"]react['"]/.test(t)||/require\s*\(\s*['"]react['"]\s*\)/.test(t)||["javascriptreact","typescriptreact"].includes(e.languageId)||/<[A-Z]\w*/.test(t)||/<\/\w+>/.test(t)?"react":/import\s+.*\s+from\s+['"]vue['"]/.test(t)||/require\s*\(\s*['"]vue['"]\s*\)/.test(t)?"vue":/@Component\s*\(/.test(t)||/@Injectable\s*\(/.test(t)?"angular":void 0}detectReactFramework(e,t,n){const r=e.getText(),a=/import\s+.*\s+from\s+['"]react['"]/.test(r)||/require\s*\(\s*['"]react['"]\s*\)/.test(r)||["javascriptreact","typescriptreact"].includes(e.languageId)||e.fileName.endsWith(".jsx")||e.fileName.endsWith(".tsx");if(!a)return/<[A-Z]\w*/.test(r)||/<\/\w+>/.test(r)?"react":void 0;if(t){const n=t.name;if(/^[A-Z]/.test(n)&&(t.kind===o.SymbolKind.Function||t.kind===o.SymbolKind.Variable||t.kind===o.SymbolKind.Constant))return"react";if(t.kind===o.SymbolKind.Class){const n=t.range,r=e.getText(n);if(/extends\s+(React\.)?Component/.test(r)||/extends\s+(React\.)?PureComponent/.test(r))return"react"}if(/^use[A-Z]/.test(n)&&t.kind===o.SymbolKind.Function)return"react";if(/^with[A-Z]/.test(n)&&t.kind===o.SymbolKind.Function)return"react";if(n.endsWith("Provider")||n.endsWith("Consumer")||n.endsWith("Context"))return"react";const r=e.lineAt(t.range.start.line).text;if(/React\.memo\s*\(/.test(r)||/React\.forwardRef\s*\(/.test(r)||/memo\s*\(/.test(r)||/forwardRef\s*\(/.test(r))return"react"}return a?"react":void 0}}t.JavaScriptHandler=f},398:e=>{e.exports=require("vscode")},479:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.CacheBenchmarks=t.HandlerBenchmarks=t.BenchmarkRunner=void 0,t.runAllBenchmarks=g,t.registerBenchmarkCommand=function(e){const t=o.commands.registerCommand("extension.runBenchmarks",async()=>{if("Yes"===await o.window.showWarningMessage("Running benchmarks will create temporary files and may impact performance. Continue?","Yes","No")){o.window.showInformationMessage("Running performance benchmarks...");const e=(await Promise.resolve().then(()=>s(n(144)))).handlerRegistry.getAllHandlers();await g(e),o.window.showInformationMessage("Benchmarks complete. Check the output channel for results.")}});e.subscriptions.push(t)};const o=s(n(398)),c=s(n(928)),l=n(987),u=n(265),d=n(880);class h{constructor(){this.results=[],this.telemetry=d.TelemetryReporter.getInstance()}async runBenchmark(e,t,n=100,r=10){for(let c=0;c<r;c++)await t();const a=[],i=l.performance.now();for(let c=0;c<n;c++){const e=l.performance.now();await t();const n=l.performance.now();a.push(n-e)}const s=l.performance.now()-i,o=this.calculateStatistics(e,a,s,n);return this.results.push(o),this.telemetry.trackPerformance(`benchmark_${e}`,o.averageTime),o}calculateStatistics(e,t,n,r){const a=t.reduce((e,t)=>e+t,0)/r,i=Math.min(...t),s=Math.max(...t),o=t.map(e=>Math.pow(e-a,2)).reduce((e,t)=>e+t,0)/r,c=Math.sqrt(o);return{name:e,iterations:r,totalTime:n,averageTime:a,minTime:i,maxTime:s,standardDeviation:c,opsPerSecond:1e3/a}}generateReport(){let e="=== Performance Benchmark Report ===\n\n";for(const t of this.results)e+=`Benchmark: ${t.name}\n`,e+=`  Iterations: ${t.iterations}\n`,e+=`  Total Time: ${t.totalTime.toFixed(2)}ms\n`,e+=`  Average Time: ${t.averageTime.toFixed(3)}ms\n`,e+=`  Min Time: ${t.minTime.toFixed(3)}ms\n`,e+=`  Max Time: ${t.maxTime.toFixed(3)}ms\n`,e+=`  Std Deviation: ${t.standardDeviation.toFixed(3)}ms\n`,e+=`  Ops/Second: ${t.opsPerSecond.toFixed(1)}\n\n`;return e}exportResults(){return JSON.stringify(this.results,null,2)}clearResults(){this.results=[]}}t.BenchmarkRunner=h;class m{constructor(){this.runner=new h}async runAll(e){for(const r of e)await this.benchmarkHandler(r);const t=this.runner.generateReport(),n=o.window.createOutputChannel("Copy Reference Benchmarks");n.appendLine(t),n.show()}async benchmarkHandler(e){const t=await this.createTestFile(e.languageId);if(t)try{const n=await o.workspace.openTextDocument(t),r=new o.Position(10,10);await this.runner.runBenchmark(`${e.languageId}_extract_reference`,async()=>{await e.extractReference(n,r)},100,10),await this.runner.runBenchmark(`${e.languageId}_resolve_symbol`,async()=>{await e.resolveSymbol(n,r)},100,10)}finally{await o.workspace.fs.delete(t)}}async createTestFile(e){const t=this.getTestContent(e);if(!t)return null;const n=this.getFileExtension(e),r=`benchmark_test_${Date.now()}${n}`,a=o.Uri.file(c.join("/tmp",r));return await o.workspace.fs.writeFile(a,Buffer.from(t)),a}getTestContent(e){return{javascript:"\n                class TestClass {\n                    constructor() {\n                        this.prop = 'value';\n                    }\n\n                    method1() {\n                        return this.prop;\n                    }\n\n                    method2(param) {\n                        return param * 2;\n                    }\n\n                    static staticMethod() {\n                        return 'static';\n                    }\n                }\n\n                function globalFunction(a, b) {\n                    return a + b;\n                }\n\n                const arrowFunction = (x) => x * x;\n\n                export { TestClass, globalFunction };\n            ",python:'\n                class TestClass:\n                    """Test class for benchmarking"""\n\n                    def __init__(self):\n                        self.prop = \'value\'\n\n                    def method1(self):\n                        """Test method 1"""\n                        return self.prop\n\n                    def method2(self, param):\n                        """Test method 2"""\n                        return param * 2\n\n                    @staticmethod\n                    def static_method():\n                        """Static method"""\n                        return \'static\'\n\n                    @classmethod\n                    def class_method(cls):\n                        """Class method"""\n                        return cls.__name__\n\n                def global_function(a, b):\n                    """Global function"""\n                    return a + b\n\n                lambda_func = lambda x: x * x\n            ',markdown:"\n                # Test Document\n\n                ## Section 1\n\n                This is a test paragraph with some content.\n\n                ### Subsection 1.1\n\n                - Item 1\n                - Item 2\n                - Item 3\n\n                ## Section 2\n\n                Another section with code:\n\n                ```javascript\n                const test = 'code';\n                ```\n\n                ### Subsection 2.1\n\n                More content here.\n\n                ## Section 3\n\n                Final section with a table:\n\n                | Column 1 | Column 2 |\n                |----------|----------|\n                | Value 1  | Value 2  |\n            ",html:'\n                <!DOCTYPE html>\n                <html lang="en">\n                <head>\n                    <title>Test Document</title>\n                </head>\n                <body>\n                    <header id="main-header">\n                        <nav id="navigation">\n                            <ul>\n                                <li><a href="#section1">Section 1</a></li>\n                                <li><a href="#section2">Section 2</a></li>\n                            </ul>\n                        </nav>\n                    </header>\n\n                    <main id="content">\n                        <section id="section1" class="section">\n                            <h1>Section 1</h1>\n                            <p>Test content for section 1.</p>\n                        </section>\n\n                        <section id="section2" class="section">\n                            <h2>Section 2</h2>\n                            <div class="subsection">\n                                <p>Test content for section 2.</p>\n                            </div>\n                        </section>\n                    </main>\n\n                    <footer id="main-footer">\n                        <p>Footer content</p>\n                    </footer>\n                </body>\n                </html>\n            ',yaml:"\n                # Test YAML configuration\n                app:\n                  name: Test Application\n                  version: 1.0.0\n                  features:\n                    - feature1\n                    - feature2\n                    - feature3\n\n                server:\n                  host: localhost\n                  port: 8080\n                  ssl:\n                    enabled: true\n                    cert: /path/to/cert\n                    key: /path/to/key\n\n                database:\n                  primary:\n                    host: db.example.com\n                    port: 5432\n                    name: testdb\n                    credentials:\n                      user: admin\n                      password: secret\n\n                cache:\n                  provider: redis\n                  config:\n                    host: cache.example.com\n                    port: 6379\n                    ttl: 3600\n            "}[e]||null}getFileExtension(e){return{javascript:".js",typescript:".ts",javascriptreact:".jsx",typescriptreact:".tsx",python:".py",markdown:".md",html:".html",xml:".xml",yaml:".yml"}[e]||".txt"}}t.HandlerBenchmarks=m;class f{constructor(){this.runner=new h,this.cache=u.CacheManager.getInstance()}async runAll(){await this.benchmarkCacheOperations(),await this.benchmarkEvictionStrategies();const e=this.runner.generateReport(),t=o.window.createOutputChannel("Cache Benchmarks");t.appendLine(e),t.show()}async benchmarkCacheOperations(){const e=o.Uri.file("/tmp/cache_test.js");await o.workspace.fs.writeFile(e,Buffer.from('const test = "content";'));const t=await o.workspace.openTextDocument(e),n=[new o.DocumentSymbol("test","",o.SymbolKind.Variable,new o.Range(0,0,0,10),new o.Range(0,0,0,10))];await this.runner.runBenchmark("cache_set",async()=>{this.cache.set(t,n)},1e3,100),await this.runner.runBenchmark("cache_get_hit",async()=>{this.cache.get(t)},1e3,100);const r=o.Uri.file("/tmp/missing.js"),a=await o.workspace.openTextDocument(r);await this.runner.runBenchmark("cache_get_miss",async()=>{this.cache.get(a)},1e3,100),await o.workspace.fs.delete(e),await o.workspace.fs.delete(r)}async benchmarkEvictionStrategies(){}}async function g(e){const t=new m,n=new f;await t.runAll(e),await n.runAll()}t.CacheBenchmarks=f},491:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.CacheEntry=t.ClipboardEntry=t.SymbolContext=t.ReferenceFormat=void 0;const o=s(n(398));t.ReferenceFormat=class{constructor(e,t="standard",n,r="#",a,i,s,o){this.filePath=e,this.formatType=t,this.symbolPath=n,this.separator=r,this.lineNumber=a,this.columnNumber=i,this.modulePath=s,this.frameworkType=o}toString(){if("fallback"===this.formatType)return`${this.filePath}:${this.lineNumber}:${this.columnNumber}`;const e=this.modulePath||this.filePath;return this.symbolPath&&this.symbolPath.length>0?`${e}${this.separator}${this.symbolPath.join(".")}`:e}validate(){return!(!this.filePath||"fallback"===this.formatType&&(!this.lineNumber||this.lineNumber<1)||this.symbolPath&&this.symbolPath.some(e=>e.includes(this.separator)))}},t.SymbolContext=class{constructor(e,t,n,r,a=[],i){this.document=e,this.position=t,this.languageId=n,this.symbol=r,this.parentSymbols=a,this.frameworkType=i}getFullSymbolPath(){const e=[];return this.parentSymbols.forEach(t=>e.push(t.name)),this.symbol&&e.push(this.symbol.name),e}isInsideSymbol(){return void 0!==this.symbol}getContainingClass(){return this.parentSymbols.find(e=>e.kind===o.SymbolKind.Class||e.kind===o.SymbolKind.Interface)}getContainingMethod(){return!this.symbol||this.symbol.kind!==o.SymbolKind.Method&&this.symbol.kind!==o.SymbolKind.Function?this.parentSymbols.find(e=>e.kind===o.SymbolKind.Method||e.kind===o.SymbolKind.Function):this.symbol}},t.ClipboardEntry=class{constructor(e,t,n,r){this.content=e,this.success=t,this.languageHandler=n,this.source=r,this.timestamp=new Date}async copyToClipboard(){try{return await o.env.clipboard.writeText(this.content),!0}catch(e){return!1}}validate(){return this.content.length>0&&this.content.length<=32768}},t.CacheEntry=class{constructor(e,t,n){this.documentUri=e,this.documentVersion=t,this.symbols=n,this.accessCount=0,this.timestamp=new Date}isValid(e){return e.uri.toString()===this.documentUri&&e.version===this.documentVersion}touch(){this.accessCount++}getAge(){return Date.now()-this.timestamp.getTime()}}},528:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.YamlHandler=void 0;const r=n(958),a=n(491),i=n(688),s=n(898),o=n(949);class c extends r.BaseLanguageHandler{constructor(){super("yaml",[".yml",".yaml"],60,!1)}canHandle(e){if("yaml"===e.languageId)return!0;const t=e.fileName.toLowerCase();return this.fileExtensions.some(e=>t.endsWith(e))}async extractReference(e,t){return(0,o.measureAsync)("YamlHandler.extractReference",async()=>{try{const n=i.ReferenceFormatter.getRelativePath(e.uri);let r=this.getCachedSymbols(e);if(r||(r=await s.SymbolResolver.getDocumentSymbols(e)||null,r&&this.setCachedSymbols(e,r)),!r||0===r.length)return new a.ReferenceFormat(n,"standard",void 0,":",t.line+1,t.character+1,n);const{symbol:o,parents:c}=this.findKeyAtPosition(r,t);if(!o&&0===c.length)return new a.ReferenceFormat(n,"standard",void 0,":",t.line+1,t.character+1,n);const l=this.buildKeyPath(c,o);return new a.ReferenceFormat(n,"standard",l,".",void 0,void 0,n)}catch(n){return null}},{languageId:e.languageId})}async resolveSymbol(e,t){return(0,o.measureAsync)("YamlHandler.resolveSymbol",async()=>{try{const n=await s.SymbolResolver.getDocumentSymbols(e);if(!n)return null;const{symbol:r,parents:i}=this.findKeyAtPosition(n,t);return r||0!==i.length?new a.SymbolContext(e,t,e.languageId,r||i[i.length-1],i,void 0):null}catch(n){return null}},{languageId:e.languageId})}formatReference(e){const t=i.ReferenceFormatter.getRelativePath(e.document.uri);if(!e.symbol)return new a.ReferenceFormat(t,"standard",void 0,":",e.position.line+1,e.position.character+1,t);const n=this.buildKeyPath(e.parentSymbols,e.symbol);return new a.ReferenceFormat(t,"standard",n,".",void 0,void 0,t)}toString(e){if(!e.symbolPath||0===e.symbolPath.length)return e.filePath;const t=e.symbolPath.map(e=>/^\d+$/.test(e)?`[${e}]`:e).reduce((e,t)=>t.startsWith("[")?e+t:e?`${e}.${t}`:t,"");return`${e.filePath}:${t}`}findKeyAtPosition(e,t){let n,r=[],a=null;const i=(e,s)=>{for(const o of e)o.range.contains(t)&&((!a||o.range.start.line>=a.start.line&&o.range.end.line<=a.end.line)&&(n=o,r=[...s],a=o.range),o.children&&o.children.length>0&&i(o.children,[...s,o]))};return i(e,[]),{symbol:n,parents:r}}buildKeyPath(e,t){const n=[];for(const r of e){const e=this.extractKeyName(r);e&&n.push(e)}if(t){const e=this.extractKeyName(t);e&&n.push(e)}return n}extractKeyName(e){let t=e.name;const n=t.match(/^\[(\d+)\]$/);if(n)return n[1];if(t.startsWith("Document "))return"";const r=t.indexOf(":");return r>0&&(t=t.substring(0,r)),t.trim()}}t.YamlHandler=c},601:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CustomFormatProvider=t.StackTraceFormatProvider=t.JavadocFormatProvider=t.MarkdownFormatProvider=t.FilePathFormatProvider=t.WithLineFormatProvider=t.QualifiedFormatProvider=void 0;const r=n(776),a=n(923);class i extends r.BaseFormatProvider{constructor(){super(a.ReferenceFormatType.QUALIFIED,"Qualified Reference","Fully qualified reference with package/module name","com.example.UserService#login")}format(e){const t=[];e.package&&t.push(e.package),e.class&&t.push(e.class);const n=t.join(".");return e.method?`${n}#${e.method}`:e.field?`${n}#${e.field}`:n}}t.QualifiedFormatProvider=i;class s extends r.BaseFormatProvider{constructor(){super(a.ReferenceFormatType.WITH_LINE,"With Line Number","Qualified reference with line number","com.example.UserService#login:42")}format(e){return(new i).format(e)+this.formatLineNumber(e.line)}}t.WithLineFormatProvider=s;class o extends r.BaseFormatProvider{constructor(){super(a.ReferenceFormatType.FILE_PATH,"File Path","Relative file path with line number","src/main/UserService.java:42")}format(e){return`${this.getDisplayFilePath(e)}${this.formatLineNumber(e.line)}`}}t.FilePathFormatProvider=o;class c extends r.BaseFormatProvider{constructor(){super(a.ReferenceFormatType.MARKDOWN,"Markdown Link","Markdown hyperlink format for documentation","[UserService#login](src/main/UserService.java#L42)")}format(e){let t=e.class||"";return e.method?t+=`#${e.method}`:e.field&&(t+=`#${e.field}`),`[${t}](${this.getDisplayFilePath(e)}${e.line?`#L${e.line}`:""})`}}t.MarkdownFormatProvider=c;class l extends r.BaseFormatProvider{constructor(){super(a.ReferenceFormatType.JAVADOC,"Javadoc Style","Javadoc @link tag format","{@link UserService#login()}")}format(e){let t=e.class||"";return e.method?t+=`#${e.method}()`:e.field&&(t+=`#${e.field}`),`{@link ${t}}`}supportsLanguage(e){return"java"===e||"kotlin"===e}}t.JavadocFormatProvider=l;class u extends r.BaseFormatProvider{constructor(){super(a.ReferenceFormatType.STACK_TRACE,"Stack Trace Style","Java stack trace format for error reporting","at UserService.login(UserService.java:42)")}format(e){return`at ${e.class||"Unknown"}.${e.method||"unknown"}(${e.fileName||"Unknown.java"}:${e.line||0})`}supportsLanguage(e){return"java"===e||"kotlin"===e}}t.StackTraceFormatProvider=u;class d extends r.BaseFormatProvider{constructor(e,t="Custom Format",n="User-defined format"){super(a.ReferenceFormatType.CUSTOM,t,n,e),this.template=e}format(e){let t=this.template;const n={"${package}":e.package||"","${class}":e.class||"","${method}":e.method||"","${field}":e.field||"","${file}":e.file||"","${fileName}":e.fileName||"","${line}":e.line?.toString()||"","${column}":e.column?.toString()||"","${fullReference}":e.fullReference||"","${separator}":e.separator||"#","${languageId}":e.languageId||"","${workspace}":e.workspace||""};for(const[r,a]of Object.entries(n))t=t.replace(new RegExp(r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),a);return t}}t.CustomFormatProvider=d},618:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.FormatManager=void 0;const o=s(n(398)),c=n(923),l=n(601);class u{constructor(){this.providers=new Map,this.customProviders=new Map,this.lastUsedFormat=c.ReferenceFormatType.QUALIFIED,this.languageFormats=new Map,this.registerBuiltinFormats(),this.loadConfiguration()}static getInstance(){return u.instance||(u.instance=new u),u.instance}registerBuiltinFormats(){const e=[new l.QualifiedFormatProvider,new l.WithLineFormatProvider,new l.FilePathFormatProvider,new l.MarkdownFormatProvider,new l.JavadocFormatProvider,new l.StackTraceFormatProvider];for(const t of e)this.providers.set(t.type,t)}loadConfiguration(){const e=o.workspace.getConfiguration("copyReference"),t=e.get("defaultFormat");t&&this.isValidFormatType(t)&&(this.lastUsedFormat=t);const n=e.get("languageFormats");if(n)for(const[a,i]of Object.entries(n))this.isValidFormatType(i)&&this.languageFormats.set(a,i);const r=e.get("customFormats");if(r)for(const[a,i]of Object.entries(r)){const e=new l.CustomFormatProvider(i,a,`Custom format: ${a}`);this.customProviders.set(a,e)}}isValidFormatType(e){return Object.values(c.ReferenceFormatType).includes(e)}getProvider(e){return this.providers.get(e)}getCustomProvider(e){return this.customProviders.get(e)}getAvailableProviders(e){const t=[];for(const n of this.providers.values())n.supportsLanguage(e)&&t.push(n);for(const n of this.customProviders.values())t.push(n);return t}getDefaultFormat(e){return this.languageFormats.get(e)||this.lastUsedFormat}setLastUsedFormat(e){this.lastUsedFormat=e}format(e,t){const n=t||this.getDefaultFormat(e.languageId||""),r=this.getProvider(n);if(!r){const t=this.getProvider(c.ReferenceFormatType.QUALIFIED);return t?.format(e)||""}return r.format(e)}async showFormatPicker(e){const t=this.getAvailableProviders(e).map(e=>({label:e.displayName,description:e.description,detail:`Example: ${e.example}`,formatType:e.type,customName:e.type===c.ReferenceFormatType.CUSTOM?e.displayName:void 0})),n=await o.window.showQuickPick(t,{placeHolder:"Choose reference format",matchOnDescription:!0,matchOnDetail:!0});if(!n)return;const r=o.workspace.getConfiguration("copyReference").get("rememberLastFormat",!0);return{format:n.formatType,customName:n.customName,remember:r}}getConfiguration(){const e=o.workspace.getConfiguration("copyReference");return{defaultFormat:this.lastUsedFormat,showFormatPicker:e.get("showFormatPicker",!1),rememberLastFormat:e.get("rememberLastFormat",!0),languageFormats:e.get("languageFormats"),customFormats:e.get("customFormats"),includeLineNumber:e.get("includeLineNumber",!1),includeFilePath:e.get("includeFilePath",!1)}}}t.FormatManager=u},645:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.ClipboardManager=void 0;const o=s(n(398));t.ClipboardManager=class{static async writeText(e){try{return await o.env.clipboard.writeText(e),!0}catch(t){return t instanceof Error&&(t.message.includes("xsel")||t.message.includes("xclip")?o.window.showErrorMessage(o.l10n.t("extension.copyReference.xselMissing")):o.window.showErrorMessage(o.l10n.t("extension.copyReference.clipboardError"))),!1}}static async readText(){try{return await o.env.clipboard.readText()}catch(e){return""}}static showSuccess(){o.window.showInformationMessage(o.l10n.t("extension.copyReference.copied"))}static showError(e){o.window.showErrorMessage(e||o.l10n.t("extension.copyReference.failed"))}}},678:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizationManager=void 0;const o=s(n(398));class c{static getMessage(e,...t){try{return o.l10n.t(e,...t)}catch{const n=this.DEFAULT_MESSAGES[e];return n?this.formatMessage(n,t):e}}static formatMessage(e,t){return t&&0!==t.length?e.replace(/\{(\d+)\}/g,(e,n)=>{const r=parseInt(n,10);return r<t.length?String(t[r]):e}):e}static getAllKeys(){return Object.keys(this.DEFAULT_MESSAGES)}static hasKey(e){return e in this.DEFAULT_MESSAGES}}t.LocalizationManager=c,c.DEFAULT_MESSAGES={"extension.copyReference.title":"Copy Reference","extension.copyReference.description":"Copy reference path like IntelliJ IDEA","extension.copyReference.noEditor":"Please open a file in editor","extension.copyReference.copied":"Reference path copied to clipboard","extension.copyReference.failed":"Unable to determine reference path","extension.copyReference.clipboardError":"Failed to copy to clipboard","extension.copyReference.xselMissing":"Clipboard requires xsel or xclip on Linux. Install via: sudo apt install xsel","extension.copyReference.cursorPosition":"Please place cursor on a class or method name","extension.copyReference.noSymbols":"No symbols found. Make sure the file has a valid structure.","extension.copyReference.unsavedFile":"Untitled","extension.copyReference.parseError":"Failed to parse document","extension.copyReference.timeout":"Operation timed out"}},688:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceFormatter=void 0;const o=s(n(928)),c=s(n(398));t.ReferenceFormatter=class{static getRelativePath(e){const t=c.workspace.getWorkspaceFolder(e);return t?o.relative(t.uri.fsPath,e.fsPath).replace(/\\/g,"/"):o.basename(e.fsPath)}static getModulePath(e){return this.getRelativePath(e).replace(/\.(js|jsx|ts|tsx|mjs|cjs)$/i,"")}static getPythonModulePath(e){return this.getRelativePath(e).replace(/\.py$/i,"").replace(/\//g,".").replace(/\\/g,".")}static generateMarkdownAnchor(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"")}static generateYamlKeyPath(e){return e.join(".")}static getFlutterPackagePath(e,t){const n=this.getRelativePath(e);if(n.startsWith("lib/")){const e=n.substring(4);if(t)return`package:${t}/${e}`}return n}static escapeReference(e){return e.replace(/[<>]/g,"")}static formatSymbolPath(e,t="."){return e.filter(e=>e&&e.length>0).join(t)}static isUnsavedFile(e){return e.isUntitled||"untitled"===e.uri.scheme}static getUnsavedFileName(e){return e.isUntitled?c.l10n.t("extension.copyReference.unsavedFile")||"Untitled":o.basename(e.uri.fsPath)}static isValidReference(e){return e.length>0&&e.length<=500}static truncateReference(e,t=500){if(e.length<=t)return e;const n=e.substring(0,t-3),r=Math.max(n.lastIndexOf("#"),n.lastIndexOf("."),n.lastIndexOf("/"));return r>t/2?n.substring(0,r)+"...":n+"..."}}},760:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackCollector=t.FeedbackType=void 0,t.registerFeedbackCommand=function(e){const t=o.commands.registerCommand("extension.copyReference.feedback",async()=>{const e=u.getInstance();await e.promptForFeedback()});e.subscriptions.push(t),50===e.globalState.get("copyReferenceUseCount",0)&&setTimeout(()=>{u.getInstance().showRatingReminder()},5e3)};const o=s(n(398)),c=n(880);var l;!function(e){e.BUG="bug",e.FEATURE="feature",e.IMPROVEMENT="improvement",e.GENERAL="general"}(l||(t.FeedbackType=l={}));class u{constructor(){this.feedbackUrl="https://github.com/xuezhouyang/another-copy-reference-like-intellij/issues",this.emailAddress="xuezhouyang@gmail.com",this.telemetry=c.TelemetryReporter.getInstance()}static getInstance(){return u.instance||(u.instance=new u),u.instance}async promptForFeedback(e){const t=await o.window.showQuickPick([" Working Great"," Report Bug"," Suggest Feature"," Contact Developer"," Rate Extension"],{placeHolder:"How is your experience with Copy Reference?",ignoreFocusOut:!0});if(t)switch(t){case" Working Great":await this.handlePositiveFeedback();break;case" Report Bug":await this.reportBug(e);break;case" Suggest Feature":await this.suggestFeature();break;case" Contact Developer":await this.contactDeveloper();break;case" Rate Extension":await this.rateExtension()}}async handlePositiveFeedback(){this.telemetry.trackEvent("feedback_positive"),"Yes, Rate Now"===await o.window.showInformationMessage("Thank you! Would you like to rate the extension on the marketplace?","Yes, Rate Now","Maybe Later")&&await this.rateExtension()}async reportBug(e){const t=await o.window.showInputBox({prompt:"Please describe the bug",placeHolder:"What went wrong?",ignoreFocusOut:!0,validateInput:e=>!e||e.trim().length<10?"Please provide at least 10 characters":null});if(!t)return;const n=this.collectSystemInfo(e),r=this.formatBugReport(t,n);switch(this.telemetry.trackEvent("feedback_bug",{hasContext:e?"true":"false"}),await o.window.showQuickPick(["Open GitHub Issue","Copy Bug Report to Clipboard","Send via Email"],{placeHolder:"How would you like to submit this bug report?"})){case"Open GitHub Issue":await this.openGitHubIssue("bug",r);break;case"Copy Bug Report to Clipboard":await o.env.clipboard.writeText(r),o.window.showInformationMessage("Bug report copied to clipboard");break;case"Send via Email":await this.sendEmail("Bug Report",r)}}async suggestFeature(){const e=await o.window.showInputBox({prompt:"Describe your feature idea",placeHolder:"What feature would you like to see?",ignoreFocusOut:!0,validateInput:e=>!e||e.trim().length<20?"Please provide at least 20 characters":null});if(!e)return;this.telemetry.trackEvent("feedback_feature");const t=this.formatFeatureRequest(e);switch(await o.window.showQuickPick(["Open GitHub Issue","Copy to Clipboard","Send via Email"],{placeHolder:"How would you like to submit this feature request?"})){case"Open GitHub Issue":await this.openGitHubIssue("enhancement",t);break;case"Copy to Clipboard":await o.env.clipboard.writeText(t),o.window.showInformationMessage("Feature request copied to clipboard");break;case"Send via Email":await this.sendEmail("Feature Request",t)}}async contactDeveloper(){switch(await o.window.showQuickPick(["Open GitHub Repository","Send Email","Copy Email Address"],{placeHolder:"How would you like to contact the developer?"})){case"Open GitHub Repository":o.env.openExternal(o.Uri.parse(this.feedbackUrl));break;case"Send Email":await this.sendEmail("Copy Reference Feedback","");break;case"Copy Email Address":await o.env.clipboard.writeText(this.emailAddress),o.window.showInformationMessage(`Email address copied: ${this.emailAddress}`)}}async rateExtension(){o.env.openExternal(o.Uri.parse("https://marketplace.visualstudio.com/items?itemName=xuezhouyang.another-copy-reference-like-intellij&ssr=false#review-details")),this.telemetry.trackEvent("feedback_rate")}collectSystemInfo(e){const t=o.extensions.getExtension("xuezhouyang.another-copy-reference-like-intellij");return{"Extension Version":t?.packageJSON.version||"Unknown","VS Code Version":o.version,Platform:process.platform,Language:e?.languageId||"N/A",Handler:e?.handlerId||"N/A",Timestamp:(new Date).toISOString()}}formatBugReport(e,t){let n="## Bug Report\n\n";n+=`**Description:**\n${e}\n\n`,n+="**System Information:**\n";for(const[r,a]of Object.entries(t))n+=`- ${r}: ${a}\n`;return n+="\n**Steps to Reproduce:**\n",n+="1. [First step]\n",n+="2. [Second step]\n",n+="3. [Third step]\n\n",n+="**Expected Behavior:**\n[What should happen]\n\n",n+="**Actual Behavior:**\n[What actually happens]\n",n}formatFeatureRequest(e){let t="## Feature Request\n\n";return t+=`**Description:**\n${e}\n\n`,t+="**Use Case:**\n[Describe when/why this feature would be useful]\n\n",t+="**Proposed Solution:**\n[How might this work?]\n\n",t+="**Alternatives Considered:**\n[Any workarounds or alternatives?]\n",t}async openGitHubIssue(e,t){const n=encodeURIComponent("bug"===e?"Bug: ":"Feature Request: "),r=encodeURIComponent(t),a="bug"===e?"bug":"enhancement",i=`${this.feedbackUrl}/new?title=${n}&body=${r}&labels=${a}`;o.env.openExternal(o.Uri.parse(i))}async sendEmail(e,t){const n=encodeURIComponent(`[Copy Reference] ${e}`),r=encodeURIComponent(t),a=`mailto:${this.emailAddress}?subject=${n}&body=${r}`;o.env.openExternal(o.Uri.parse(a))}async showRatingReminder(){const e=await o.window.showInformationMessage("Enjoying Copy Reference? Please consider rating it!"," Rate Now","Later","Don't Ask Again");" Rate Now"===e?await this.rateExtension():"Don't Ask Again"===e&&this.telemetry.trackEvent("feedback_rating_declined")}async collectUsageFeedback(e,t,n){this.telemetry.trackEvent("usage_feedback",{operation:e,success:t.toString(),extensionVersion:o.extensions.getExtension("xuezhouyang.another-copy-reference-like-intellij")?.packageJSON.version,vscodeVersion:o.version,platform:process.platform,...n})}}t.FeedbackCollector=u},776:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseFormatProvider=void 0,t.BaseFormatProvider=class{constructor(e,t,n,r){this.type=e,this.displayName=t,this.description=n,this.example=r}supportsLanguage(e){return!0}buildSymbolPath(e,t="."){const n=[];return e.package&&n.push(e.package),e.class&&n.push(e.class),e.method?n.push(e.method):e.field&&n.push(e.field),n.join(t)}getDisplayFilePath(e){return e.file||e.fileName||""}formatLineNumber(e,t=":"){return e?`${t}${e}`:""}}},870:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlHandler=void 0;const r=n(958),a=n(491),i=n(688),s=n(898),o=n(949);class c extends r.BaseLanguageHandler{constructor(){super("html",[".html",".htm",".xhtml",".xml",".svg"],50,!1)}canHandle(e){const t=e.languageId;if("html"===t||"xml"===t||"xhtml"===t)return!0;const n=e.fileName.toLowerCase();return this.fileExtensions.some(e=>n.endsWith(e))}async extractReference(e,t){return(0,o.measureAsync)("HtmlHandler.extractReference",async()=>{try{const n=i.ReferenceFormatter.getRelativePath(e.uri);let r=this.getCachedSymbols(e);if(r||(r=await s.SymbolResolver.getDocumentSymbols(e)||null,r&&this.setCachedSymbols(e,r)),!r||0===r.length){const r=this.findElementAtPosition(e,t);return r?new a.ReferenceFormat(n,"standard",[r],"#",t.line+1,t.character+1,n):new a.ReferenceFormat(n,"standard",void 0,"#",t.line+1,t.character+1,n)}const o=this.findElementSymbolAtPosition(r,t);if(!o)return new a.ReferenceFormat(n,"standard",void 0,"#",t.line+1,t.character+1,n);const c=this.extractElementIdentifier(o);if(!c){const e=this.generateXPathReference(o,r);return new a.ReferenceFormat(n,"standard",[e],"#",void 0,void 0,n)}return new a.ReferenceFormat(n,"standard",[c],"#",void 0,void 0,n)}catch(n){return null}},{languageId:e.languageId})}async resolveSymbol(e,t){return(0,o.measureAsync)("HtmlHandler.resolveSymbol",async()=>{try{const n=await s.SymbolResolver.getDocumentSymbols(e);if(!n)return null;const r=this.findElementSymbolAtPosition(n,t);if(!r)return null;const i=this.findParentElements(n,r);return new a.SymbolContext(e,t,e.languageId,r,i,void 0)}catch(n){return null}},{languageId:e.languageId})}formatReference(e){const t=i.ReferenceFormatter.getRelativePath(e.document.uri);if(!e.symbol)return new a.ReferenceFormat(t,"standard",void 0,"#",e.position.line+1,e.position.character+1,t);const n=this.extractElementIdentifier(e.symbol);if(!n){const n=this.generateXPathReference(e.symbol,[]);return new a.ReferenceFormat(t,"standard",[n],"#",void 0,void 0,t)}return new a.ReferenceFormat(t,"standard",[n],"#",void 0,void 0,t)}findElementAtPosition(e,t){const n=e.lineAt(t.line).text,r=t.character,a=n.match(/id\s*=\s*["']([^"']+)["']/);if(a&&void 0!==a.index){const e=a.index,t=e+a[0].length;if(r>=e&&r<=t)return a[1]}const i=n.match(/name\s*=\s*["']([^"']+)["']/);if(i&&void 0!==i.index){const e=i.index,t=e+i[0].length;if(r>=e&&r<=t)return i[1]}const s=n.match(/data-(?:id|component)\s*=\s*["']([^"']+)["']/);if(s&&void 0!==s.index){const e=s.index,t=e+s[0].length;if(r>=e&&r<=t)return s[1]}const o=n.match(/class\s*=\s*["']([^"']+)["']/);if(o&&void 0!==o.index){const e=o.index,t=e+o[0].length;if(r>=e&&r<=t){const e=o[1].split(/\s+/);if(e.length>0)return"."+e[0]}}return null}findElementSymbolAtPosition(e,t){let n=null,r=null;const a=e=>{for(const i of e)i.range.contains(t)&&(!r||i.range.start.line>=r.start.line&&i.range.end.line<=r.end.line)&&(n=i,r=i.range),i.children&&i.children.length>0&&a(i.children)};return a(e),n}extractElementIdentifier(e){const t=e.name,n=t.match(/#([a-zA-Z0-9_-]+)/);if(n)return n[1];const r=t.match(/\[name=['"]?([^'"\]]+)['"]?\]/);if(r)return r[1];const a=t.match(/\[data-(?:id|component)=['"]?([^'"\]]+)['"]?\]/);if(a)return a[1];const i=t.match(/\.([a-zA-Z0-9_-]+)/);return i?"."+i[1]:(t.match(/^[a-z]+$/i),null)}findParentElements(e,t){const n=[],r=(e,a)=>{for(const i of e){if(i===t)return n.push(...a),!0;if(i.children&&i.children.length>0){const e=[...a,i];if(r(i.children,e))return!0}}return!1};return r(e,[]),n}generateXPathReference(e,t){const n=e.name,r=n.match(/^([a-z]+)/i),a=r?r[1]:"element",i=n.match(/\.([a-zA-Z0-9_-]+)/);if(i)return`//${a}[@class='${i[1]}']`;const s=n.match(/\[([^=]+)=['"]?([^'"\]]+)['"]?\]/);if(s)return`//${a}[@${s[1]}='${s[2]}']`;let o=1;if(t.length>0)for(const c of t){if(c===e)break;const t=c.name.match(/^([a-z]+)/i);t&&t[1]===a&&o++}return`//${a}[${o}]`}}t.HtmlHandler=c},880:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryEvents=t.TelemetryReporter=void 0,t.trackPerformance=async function(e,t){const n=Date.now(),r=c.getInstance();try{const a=await t(),i=Date.now()-n;return r.trackPerformance(e,i),a}catch(a){const t=Date.now()-n;throw r.trackPerformance(e,t),r.trackError(a,e),a}};const o=s(n(398));class c{constructor(){this.isEnabled=!1,this.events=new Map,this.sessionStart=new Date,this.checkTelemetryEnabled()}static getInstance(){return c.instance||(c.instance=new c),c.instance}initialize(e){this.context=e,o.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("telemetry")&&this.checkTelemetryEnabled()}),this.loadPersistedData()}checkTelemetryEnabled(){const e=o.workspace.getConfiguration("telemetry").get("telemetryLevel","off");this.isEnabled="off"!==e}trackEvent(e,t,n){if(!this.isEnabled)return;const r=this.events.get(e)||0;this.events.set(e,r+1),(new Date).toISOString(),this.sanitizeProperties(t),this.persistData()}trackLanguageUsage(e,t,n){this.trackEvent("copyReference",{languageId:e,handlerId:t,success:n.toString()});const r=`language_${e}`,a=this.events.get(r)||0;this.events.set(r,a+1)}trackPerformance(e,t){this.trackEvent("performance",{operation:e},{duration_ms:Math.round(t)})}trackError(e,t){this.trackEvent("error",{message:e.message,context:t||"unknown",stack:this.sanitizeStackTrace(e.stack)})}trackFeature(e,t){this.trackEvent("feature_usage",{feature:e,...this.sanitizeProperties(t)})}getSummary(){return{sessionDuration:Date.now()-this.sessionStart.getTime(),totalEvents:Array.from(this.events.values()).reduce((e,t)=>e+t,0),eventCounts:Object.fromEntries(this.events),isEnabled:this.isEnabled,sessionStart:this.sessionStart.toISOString()}}sanitizeProperties(e){if(!e)return{};const t={};for(const[n,r]of Object.entries(e)){if(this.isSensitiveKey(n))continue;let e=String(r);e.length>200&&(e=e.substring(0,200)+"..."),e=this.sanitizeFilePath(e),t[n]=e}return t}sanitizeStackTrace(e){return e?e.replace(/([A-Z]:)?[/\\]Users[/\\][^/\\\n]+/g,"/Users/***").replace(/([A-Z]:)?[/\\]home[/\\][^/\\\n]+/g,"/home/***"):"No stack trace available"}sanitizeFilePath(e){return e.replace(/([A-Z]:)?[/\\]Users[/\\][^/\\\s]+/g,"/Users/***").replace(/([A-Z]:)?[/\\]home[/\\][^/\\\s]+/g,"/home/***").replace(/([A-Z]:)?\\\\Users\\\\[^/\\\s]+/g,"\\Users\\***")}isSensitiveKey(e){return[/password/i,/token/i,/key/i,/secret/i,/credential/i,/auth/i,/private/i].some(t=>t.test(e))}persistData(){if(!this.context)return;const e={events:Object.fromEntries(this.events),lastUpdate:(new Date).toISOString()};this.context.globalState.update("telemetryData",e)}loadPersistedData(){if(!this.context)return;const e=this.context.globalState.get("telemetryData");e&&e.events&&(this.events=new Map(Object.entries(e.events)))}clearData(){this.events.clear(),this.context&&this.context.globalState.update("telemetryData",void 0)}exportData(){const e=this.getSummary();return JSON.stringify(e,null,2)}}var l;t.TelemetryReporter=c,function(e){e.COPY_REFERENCE="copyReference",e.PERFORMANCE="performance",e.ERROR="error",e.FEATURE_USAGE="feature_usage",e.LANGUAGE_USAGE="language_usage",e.FRAMEWORK_DETECTED="framework_detected",e.CACHE_HIT="cache_hit",e.CACHE_MISS="cache_miss"}(l||(t.TelemetryEvents=l={}))},886:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.UniversalHandler=void 0;const o=s(n(398)),c=s(n(928)),l=n(958),u=n(491),d=n(688),h=n(949);class m extends l.BaseLanguageHandler{constructor(){super("*",["*"],0,!1)}canHandle(e){return!0}async extractReference(e,t){return(0,h.measureAsync)("UniversalHandler.extractReference",async()=>{try{const n=await this.getDocumentSymbols(e);if(n&&n.length>0){const{symbol:r,parents:a}=this.findSymbolAtPosition(n,t),i=this.buildSymbolReference(e,t,a,r);if(i)return i}return this.buildFallbackReference(e,t)}catch(n){return null}},{languageId:e.languageId})}async resolveSymbol(e,t){return(0,h.measureAsync)("UniversalHandler.resolveSymbol",async()=>{try{return new u.SymbolContext(e,t,e.languageId,void 0,[],void 0)}catch(n){return null}},{languageId:e.languageId})}formatReference(e){return this.buildSymbolReference(e.document,e.position,e.parentSymbols,e.symbol)||this.buildFallbackReference(e.document,e.position)}getFilePath(e){return d.ReferenceFormatter.isUnsavedFile(e)?d.ReferenceFormatter.getUnsavedFileName(e):d.ReferenceFormatter.getRelativePath(e.uri)||c.basename(e.uri.fsPath)}async extractFromSymbol(e,t,n){return this.extractReference(e,t)}buildSymbolReference(e,t,n,r){const a=this.buildSymbolPath(n,r);if(0===a.length)return null;const i=this.getModulePath(e,n);return new u.ReferenceFormat(i,"standard",a,"#",void 0,void 0,i)}buildSymbolPath(e,t){const n=e.findIndex(e=>e.kind===o.SymbolKind.Package||e.kind===o.SymbolKind.Namespace||e.kind===o.SymbolKind.Module),r=e.map(e=>e.name);return t&&r.push(t.name),n>=0?r.slice(n+1):r}getModulePath(e,t){const n=t.find(e=>e.kind===o.SymbolKind.Package||e.kind===o.SymbolKind.Namespace||e.kind===o.SymbolKind.Module);return n?n.name:this.getFilePath(e).replace(/\.[^.]+$/,"")}buildFallbackReference(e,t){const n=this.getFilePath(e),r=t.line+1,a=t.character+1;return new u.ReferenceFormat(n,"fallback",void 0,":",r,a)}}t.UniversalHandler=m},896:e=>{e.exports=require("fs")},898:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolResolver=void 0;const o=s(n(398));t.SymbolResolver=class{static async getDocumentSymbols(e){try{return await o.commands.executeCommand("vscode.executeDocumentSymbolProvider",e.uri)}catch(t){return}}static findSymbolAtPosition(e,t){return this.findSymbolRecursive(e,t,[])}static findSymbolRecursive(e,t,n){for(const r of e)if(r.range.contains(t)){if(r.children&&r.children.length>0){const e=this.findSymbolRecursive(r.children,t,[...n,r]);if(e.symbol)return e}if(r.selectionRange.contains(t))return{symbol:r,parents:n}}return{symbol:void 0,parents:n}}static isClass(e){return e.kind===o.SymbolKind.Class||e.kind===o.SymbolKind.Interface}static isMethod(e){return e.kind===o.SymbolKind.Method||e.kind===o.SymbolKind.Function||e.kind===o.SymbolKind.Constructor}static isProperty(e){return e.kind===o.SymbolKind.Property||e.kind===o.SymbolKind.Field||e.kind===o.SymbolKind.Variable}static getSymbolKindName(e){return{[o.SymbolKind.File]:"File",[o.SymbolKind.Module]:"Module",[o.SymbolKind.Namespace]:"Namespace",[o.SymbolKind.Package]:"Package",[o.SymbolKind.Class]:"Class",[o.SymbolKind.Method]:"Method",[o.SymbolKind.Property]:"Property",[o.SymbolKind.Field]:"Field",[o.SymbolKind.Constructor]:"Constructor",[o.SymbolKind.Enum]:"Enum",[o.SymbolKind.Interface]:"Interface",[o.SymbolKind.Function]:"Function",[o.SymbolKind.Variable]:"Variable",[o.SymbolKind.Constant]:"Constant",[o.SymbolKind.String]:"String",[o.SymbolKind.Number]:"Number",[o.SymbolKind.Boolean]:"Boolean",[o.SymbolKind.Array]:"Array",[o.SymbolKind.Object]:"Object",[o.SymbolKind.Key]:"Key",[o.SymbolKind.Null]:"Null",[o.SymbolKind.EnumMember]:"EnumMember",[o.SymbolKind.Struct]:"Struct",[o.SymbolKind.Event]:"Event",[o.SymbolKind.Operator]:"Operator",[o.SymbolKind.TypeParameter]:"TypeParameter"}[e]||"Unknown"}static buildSymbolPath(e,t){const n=[];for(const r of e)n.push(r.name);return t&&n.push(t.name),n}}},923:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceFormatType=void 0,function(e){e.QUALIFIED="qualified",e.WITH_LINE="withLine",e.FILE_PATH="filePath",e.MARKDOWN="markdown",e.JAVADOC="javadoc",e.STACK_TRACE="stackTrace",e.CUSTOM="custom"}(n||(t.ReferenceFormatType=n={}))},928:e=>{e.exports=require("path")},949:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.PerformanceMonitor=void 0,t.measurePerformance=function(e,t,r){const a=r.value,i=n.getInstance();return r.value=async function(...n){const r=i.startTimer(`${e.constructor.name}.${t}`);try{const e=await a.apply(this,n);return r.stop(),e}catch(s){throw r.addMetadata("error",!0).stop(),s}},r},t.measureAsync=async function(e,t,r){const a=n.getInstance().startTimer(e);r&&Object.entries(r).forEach(([e,t])=>{a.addMetadata(e,t)});try{const e=await t();return a.stop(),e}catch(i){throw a.addMetadata("error",!0).stop(),i}},t.measureSync=function(e,t,r){const a=n.getInstance().startTimer(e);r&&Object.entries(r).forEach(([e,t])=>{a.addMetadata(e,t)});try{const e=t();return a.stop(),e}catch(i){throw a.addMetadata("error",!0).stop(),i}};class n{constructor(){this.metrics=new Map,this.maxMetricsPerKey=100,this.performanceThreshold=100}static getInstance(){return n.instance||(n.instance=new n),n.instance}startTimer(e){return new r(e,this)}recordMetric(e){const t=e.operation;this.metrics.has(t)||this.metrics.set(t,[]);const n=this.metrics.get(t);n.push(e),n.length>this.maxMetricsPerKey&&n.shift(),e.duration,this.performanceThreshold}getAverageDuration(e){const t=this.metrics.get(e);return t&&0!==t.length?t.reduce((e,t)=>e+t.duration,0)/t.length:null}getPercentileDuration(e,t){const n=this.metrics.get(e);if(!n||0===n.length)return null;const r=[...n].sort((e,t)=>e.duration-t.duration),a=Math.floor(t/100*r.length);return r[Math.min(a,r.length-1)].duration}getStatistics(e){const t=this.metrics.get(e);if(!t||0===t.length)return null;const n=t.map(e=>e.duration),r=[...n].sort((e,t)=>e-t);return{operation:e,count:t.length,average:n.reduce((e,t)=>e+t,0)/n.length,median:r[Math.floor(r.length/2)],min:r[0],max:r[r.length-1],p95:r[Math.floor(.95*r.length)],p99:r[Math.floor(.99*r.length)]}}getAllStatistics(){const e=[];for(const t of this.metrics.keys()){const n=this.getStatistics(t);n&&e.push(n)}return e.sort((e,t)=>t.average-e.average)}clearMetrics(e){e?this.metrics.delete(e):this.metrics.clear()}exportMetrics(){const e={};for(const t of this.metrics.keys()){const n=this.getStatistics(t);n&&(e[t]=n)}return JSON.stringify(e,null,2)}logSummary(){const e=this.getAllStatistics();if(0!==e.length)for(const t of e);}}t.PerformanceMonitor=n;class r{constructor(e,t){this.operation=e,this.monitor=t,this.metadata={},this.startTime=Date.now()}addMetadata(e,t){return this.metadata[e]=t,this}stop(){const e=Date.now()-this.startTime;return this.monitor.recordMetric({operation:this.operation,duration:e,timestamp:new Date,metadata:this.metadata}),e}}t.Timer=r},958:function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&a(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.BaseLanguageHandler=void 0;const o=s(n(398)),c=n(491);t.BaseLanguageHandler=class{constructor(e,t,n=50,r=!1){this.languageId=e,this.fileExtensions=t,this.priority=n,this.supportsFrameworks=r,this.cache=new Map,this.cacheTimeout=3e5,this.maxCacheSize=100}canHandle(e){if(e.languageId===this.languageId)return!0;const t=e.fileName.toLowerCase();return this.fileExtensions.some(e=>t.endsWith(e))}async extractReference(e,t){try{const n=await this.resolveSymbol(e,t);return n?this.formatReference(n):null}catch(n){return null}}async resolveSymbol(e,t){const n=await this.getDocumentSymbols(e);if(!n||0===n.length)return null;const{symbol:r,parents:a}=this.findSymbolAtPosition(n,t);return new c.SymbolContext(e,t,e.languageId,r,a,await this.detectFramework(e))}async getDocumentSymbols(e){const t=e.uri.toString(),n=this.cache.get(t);if(n&&n.isValid(e))return n.touch(),n.symbols;const r=await o.commands.executeCommand("vscode.executeDocumentSymbolProvider",e.uri);if(r&&r.length>0)return this.updateCache(t,e.version,r),r;const a=await this.parseCustomSymbols(e);return a.length>0&&this.updateCache(t,e.version,a),a}updateCache(e,t,n){this.cache.size>=this.maxCacheSize&&this.evictOldestEntry(),this.cleanExpiredCache(),this.cache.set(e,new c.CacheEntry(e,t,n))}evictOldestEntry(){let e,t=Date.now();for(const[n,r]of this.cache.entries()){const a=r.timestamp.getTime();a<t&&(t=a,e=n)}e&&this.cache.delete(e)}cleanExpiredCache(){const e=[];for(const[t,n]of this.cache.entries())n.getAge()>this.cacheTimeout&&e.push(t);e.forEach(e=>this.cache.delete(e))}findSymbolAtPosition(e,t,n=[]){for(const r of e)if(r.range.contains(t)){if(r.children&&r.children.length>0){const e=this.findSymbolAtPosition(r.children,t,[...n,r]);if(e.symbol)return e}if(r.range.contains(t))return{symbol:r,parents:n}}return{symbol:void 0,parents:n}}getCachedSymbols(e){const t=e.uri.toString(),n=this.cache.get(t);return n&&n.isValid(e)?(n.touch(),n.symbols):null}setCachedSymbols(e,t){const n=e.uri.toString();this.cache.size>=this.maxCacheSize&&!this.cache.has(n)&&this.evictOldestEntry(),this.cache.set(n,new c.CacheEntry(e.uri.toString(),e.version,t))}clearCache(){this.cache.clear()}dispose(){this.clearCache()}async parseCustomSymbols(e){return[]}async detectFramework(e){}}},987:e=>{e.exports=require("perf_hooks")}},t={},n=function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(144);module.exports=n})();